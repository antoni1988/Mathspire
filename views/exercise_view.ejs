<%
const exerciseData = Exercise.getExerciseData(topicId, currentPage);
if (!exerciseData) {
  throw new Error(`No exercises found for topic ${topicId}, page ${currentPage}`);
}

const { pageTitle, topicName, exercises } = exerciseData;

if (typeof dbExercises !== 'undefined') {
  exercises.forEach(ex => {
    const dbExercise = dbExercises.find(e => e.exercise_number === ex.exercise_number);
    if (dbExercise) {
      ex.id = dbExercise.id;
      ex.completed_at = dbExercise.completed_at;
    }
  });
}
%>
<%- include('components/exercise_page', { 
  pageTitle,
  topicName,
  topicId,
  exercises,
  currentPage,
  totalPages
}) %>